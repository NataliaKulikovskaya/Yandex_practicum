# Сustomer churn forecast

**Описание проекта**
Оператор связи хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.
Решена задача, которая заключалась в разработке модели машинного обучения для оператора связи. Компания стремится создать модель, которая помогла бы выявлять клиентов, которые могут решить перейти к другому оператору, с целью предлагать им специальные промокоды и условия. Главная цель заказчика заключается в том, чтобы удерживать своих текущих клиентов и увеличивать прибыль за счет этого.

**Выводы**
Был проведен исследовательский анализ данных:
1. Загружены 4 датасета содержащие информацию о договорах, персональные данные клиентов, информации об интернет-услугах, информацию об услугах телефонии.
2. Таблицы объеденены в одну, образовавшиеся пропущенные значения были проанализированы и обработаны.

4. Созданы новые признаки
5. Проведен анализ данных
* Оказалось, что в начале 2014 было заключено много новых контрактов и обнаружен спад активности в конце 2019.
* Обнаружено что ушедших клиентов на много меньше.
* было показано, что число разорванных контрактов увеличивается со временем. Самыми сложными месяцами являлись октябрь 2019 и ноябрь 2020.
* рассмотрено распределение числовых и категориальных признаков для активных и ушедших клиентов.
Оказалось, что среди ушедших клиентов есть значительный перевес в сторону высоких платежей. Это объясняет повышенную долю пользователей дополнительных услуг (streaming_tv, streaming_movies, etc) среди ушедших клиентов.
* Анализ данных показал что самая сильная корреляция между payer_class и internet_service. Если детально рассмотреть эти столбцы, то видно что большинство клиентов категории 'whale' пользуются технологией Fiber optic и, напротив, технологией DSL пользуются клиенты категорий 'fish' и 'shrimp'. Это логично, за более крутую технологию нужно больше платить. А вот колонка gender не влияет ни на что, удалим ее.

Были выбран ряд моделей для обучения (Logistic Regression, DecisionTreeClassifier, RandomForestClassifier, GradientBoostingClassifier, CatBoostClassifier, K-Nearest Neighbors, XGBClassifier) и в соответствии с этим проведеа соответствующая обработка данных, а именно масштабирование числовых и  кодирование категориальных признаков.

Модели были обучены, гиперпараметры подбирались с помощью RandomizedSearchCV. Качество моделей оценивали по метрике ROC-AUC. Random Forest Classifier, Gradient Boosting Classifier, CatBoost Classifier, XGBoost Classifier показали знпчение метрики ROC-AUC больше 0.8. Так как значения очень похожи, все они были проверены  на тестовой выборке. Random Forest CatBoost Classifier показал наилучший результат 0.91 на тестовой выборке. Модель предсказала TN - 1465 раза, FP - 21 раза, FN - 115 раз, TP - 160 раза.

Было изучено влияние признаком на предсказаня модели. Оказалось, что признак tenure является самым значимым для модели. Так же признак total charges достаточно сильно влияет на модель.

`Python` `Pandas` `Matplotlib` `Scikit-learn`



