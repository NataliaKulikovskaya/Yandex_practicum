# Сustomer churn forecast

# Описание проекта
Оператор связи хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.
Решена задача, которая заключалась в разработке модели машинного обучения для оператора связи. Компания стремится создать модель, которая помогла бы выявлять клиентов, которые могут решить перейти к другому оператору, с целью предлагать им специальные промокоды и условия. Главная цель заказчика заключается в том, чтобы удерживать своих текущих клиентов и увеличивать прибыль за счет этого.


# Описание данных
  Данные состоят из файлов, полученных из разных источников:

* contract_new.csv — информация о договоре;
* personal_new.csv — персональные данные клиента;
* internet_new.csv — информация об интернет-услугах;
* phone_new.csv — информация об услугах телефонии.

Во всех файлах столбец customerID содержит код клиента.
Информация о договорах актуальна на 1 февраля 2020.

# Выводы
Был проведен исследовательский анализ данных:
1. Загружены 4 датасета содержащие информацию о договорах, персональные данные клиентов, информации об интернет-услугах, информацию об услугах телефонии.
2. Таблицы объеденены в одну, образовавшиеся пропущенные значения были проанализированы и обработаны.
3. Значения в столбцах
  * end_date, begin_date приведены к типу datetime64[ns];
  * senior_citizen к типу object;
  * total_charges  к типу float64.
4. Созданы новые признаки
  * chern - ушел ли пользователь
  * tenere - длительность контракта
  * monthly_payment - сгруппировали по monthly_charges на 4 кагорты.
5. Проведен анализ данных
* Оказалось, что в начале 2014 было заключено много новых контрактов и обнаружен спад активности в конце 2019.
* Обнаружено что ушедших клиентов на много меньше.
* было показано, что число разорванных контрактов увеличивается со временем. Самыми сложными месяцами являлись октябрь 2019 и ноябрь 2020.
* рассмотрено распределение числовых и категориальных признаков для активных и ушедших клиентов.
Оказалось, что среди ушедших клиентов есть значительный перевес в сторону высоких платежей. Это объясняет повышенную долю пользователей дополнительных услуг (streaming_tv, streaming_movies, etc) среди ушедших клиентов.
* Анализ данных показал что самая сильная корреляция между payer_class и internet_service. Если детально рассмотреть эти столбцы, то видно что большинство клиентов категории 'whale' пользуются технологией Fiber optic и, напротив, технологией DSL пользуются клиенты категорий 'fish' и 'shrimp'. Это логично, за более крутую технологию нужно больше платить. А вот колонка gender не влияет ни на что, удалим ее.

Были выбран ряд моделей для обучения (Logistic Regression, DecisionTreeClassifier, RandomForestClassifier, GradientBoostingClassifier, CatBoostClassifier, K-Nearest Neighbors, XGBClassifier) и в соответствии с этим проведеа соответствующая обработка данных, а именно масштабирование числовых и  кодирование категориальных признаков.

Модели были обучены, гиперпараметры подбирались с помощью RandomizedSearchCV. Качество моделей оценивали по метрике ROC-AUC. Random Forest Classifier, Gradient Boosting Classifier, CatBoost Classifier, XGBoost Classifier показали знпчение метрики ROC-AUC больше 0.8. Так как значения очень похожи, все они были проверены  на тестовой выборке.

![image](https://github.com/NataliaKulikovskaya/Telecommunications/assets/144121898/58c05fa0-df55-41b8-9f1a-2f7cab29e0bd)

Random Forest CatBoost Classifier показал наилучший результат 0.91 на тестовой выборке. Модель предсказала TN - 1465 раза, FP - 21 раза, FN - 115 раз, TP - 160 раза.

Было изучено влияние признаком на предсказаня модели. Оказалось, что признак tenure является самым значимым для модели. Так же признак total charges достаточно сильно влияет на модель.

![image](https://github.com/NataliaKulikovskaya/Telecommunications/assets/144121898/714cd5ae-a35d-411d-b111-9bac2d70405d)



