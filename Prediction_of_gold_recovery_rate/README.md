# Восстановление золота из руды
Нужно подготовить прототип модели машинного обучения для компании «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Предоставлены данные с параметрами добычи и очистки. Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристикам.

## Анализ данных техпроцесса получения золота из руды

### Подготовка данных

Были предоставлены три выборки full, train, test. Выборки разного размера. В выборке test отсутсвтуют целевые признаки. В данных присутствуют пропуски, дублкатов нет.

Расчитали эффективность обогащения и нашли среднее значение. При сравнении полученного значения и значения из датасета оказалось, что величины почти одинаковы. Значение MAE 9.84e-15. Это говорит о том, что эффективность обогащения рассчитана правильно.

В тестовой выборке отсутствуют 34 признака. Не хватает выходных параметров продукта output на всех этапах техпроцесса, а так же некоторых расчётных характеристик calculation.

### Анализ данных

Было показано, что концентрация золота с каждым этапом очистки увеличивается, концентрация серебра уменьшается, концентрация свинца увеличивается после флотации и незначительно увеличивается после первого этапа очистки.

Сравнили распределения размеров гранул исходного сырья на обучающей и тестовой выборках. Размеры гранул сырья похожи, следовательно оценка модели должна быть корректна.

Было рассмотрено суммарное содержание металлов на разных стадиях технологического процесса. В черновом концентрате, в концентрате после первой очистки и в финальном концентрате наблюдаются аномалии. Суммарная концентрация веществ растет от стадии к стадии.

### Построение модели

Была написана функция для вычисления итоговой sMAPE (симметричной средней абсолютной процентной ошибки).

Были обучены модели LinearRegression и DecisionTreeRegressor.

Лучшее значение sMAPE у модели DecisionTreeRegressor 8.33 % на глубине 3.

Модель была проверена на тестовой выборке. Итоговое значение sMAPE для полученное на тестовой выборке на 1% меньше, чем на константной модели.


